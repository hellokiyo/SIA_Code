package teamproject;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;

public class EmpService {
	
	public static Map<String, EmpMethod> statsMap = new HashMap<>();
	
	static {
		statsMap.put("ì´ë¦„", EmpService::printEmpListByName);
		statsMap.put("ì…ì‚¬ë…„ë„", EmpService::printEmpListByHireYear);
		statsMap.put("ë¶€ì„œë²ˆí˜¸", EmpService::printEmpListByDeptNo);
		statsMap.put("ì§ë¬´", EmpService::printEmpListByJobId);
		statsMap.put("ë„ì‹œ", EmpService::printEmpListByCity);
		statsMap.put("ê¸‰ì—¬", EmpService::printStatsBySal);
		statsMap.put("ë¶€ì„œë³„ ê¸‰ì—¬", EmpService::printAvgSalByDept);
		statsMap.put("ë¶€ì„œì¥", EmpService::printMemByDeptMngr);
		statsMap.put("ë‚˜ë¼", EmpService::printEmpListByCountry);
	}
	
	public static void printEmpListByName(String name) {
		if(name.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		
		Scanner namescan = new Scanner(name);
		List<Emp> empList = EmpDAO.searchByName(namescan);
		
		if (empList==null || empList.isEmpty()) {
			System.out.println("í•´ë‹¹ ì´ë¦„ì˜ ì§ì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
			return;
		} else {
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printEmpListByHireYear(String hireYearStr) {
		if (hireYearStr.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		int hireYear;
		try {
			hireYear = Integer.parseInt(hireYearStr);
		} catch (Exception e) {
			if (hireYearStr.equals("í†µê³„")) {
				List<Emp> statsList = EmpDAO.getStatsByHireYear();
				if (statsList==null || statsList.isEmpty()) {
					System.out.println("ì…ì‚¬ë…„ë„ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
					return;
				}
				System.out.println("ğŸ“†ğŸ“Š [ì…ì‚¬ë…„ë„ í†µê³„]");
				System.out.println("===================================================");
				for (Emp emp : statsList) {
					System.out.println(emp.hireYearStats());
				}
				System.out.println("===================================================");
				return;
			}
			System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤.");
			return;
		}
		Scanner hirescan = new Scanner(hireYearStr); //ì´ˆê¸°í™”
		List<Emp> empList = EmpDAO.searchByHireYear(hirescan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("í•´ë‹¹ ë…„ë„ì— ì…ì‚¬í•œ ì§ì›ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸ“† " + hireYear + "ë…„ ì…ì‚¬í•œ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printEmpListByDeptNo(String deptIdStr) {
		if (deptIdStr.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		int deptId;
		try {
			deptId = Integer.parseInt(deptIdStr);
		} catch (Exception e) {
			if (deptIdStr.equals("í†µê³„")) {
				List<Emp> statsList = EmpDAO.getStatsByDeptNo();
				if (statsList==null || statsList.isEmpty()) {
					System.out.println("ë¶€ì„œë²ˆí˜¸ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
					return;
				}
				System.out.println("ğŸ—‚ï¸ğŸ“Š [ë¶€ì„œë²ˆí˜¸ í†µê³„]");
				System.out.println("===================================================");
				for (Emp emp : statsList) {
					System.out.println(emp.deptNoStats());
				}
				System.out.println("===================================================");
				return;
			}
			System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤.");
			return;
		}
		
		Scanner deptscan = new Scanner(deptIdStr);
		List<Emp> empList = EmpDAO.searchByDeptNo(deptscan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("í•´ë‹¹ ë¶€ì„œì— ì§ì›ì´ ì¡´ì¬í•˜ì§€ ì•Šê±°ë‚˜ ë¶€ì„œ ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸ—‚ï¸ " + deptId + "ë²ˆ ë¶€ì„œ ë‚´ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printEmpListByJobId(String jobId) {
		if (jobId.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else if (jobId.equals("í†µê³„")) {
			List<Emp> statsList = EmpDAO.getStatsByJobId();
			if (statsList==null || statsList.isEmpty()) {
				System.out.println("ì§ë¬´ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				return;
			}
			System.out.println("ğŸ“ğŸ“Š [ì§ë¬´ í†µê³„]");
			System.out.println("===================================================");
			for (Emp emp : statsList) {
				System.out.println(emp.jobIdStats());
			}
			System.out.println("===================================================");
			return;
		}
		
		Scanner jobscan = new Scanner(jobId);
		List<Emp> empList = EmpDAO.searchByJobId(jobscan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("í•´ë‹¹ ì§ë¬´ë¥¼ ìˆ˜í–‰ ì¤‘ì¸ ì§ì›ì´ ì—†ê±°ë‚˜ ì…ë ¥ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸ“ " + jobId + " ì§ë¬´ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printEmpListByCity(String city) {
		if (city.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else if (city.equals("í†µê³„")) {
			List<Emp> statsList = EmpDAO.getStatsByCity();
			if (statsList==null || statsList.isEmpty()) {
				System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë„ì‹œ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				return;
			}
			System.out.println("ğŸ™ï¸ğŸ“Š [ë„ì‹œ í†µê³„]");
			System.out.println("===================================================");
			for (Emp emp : statsList) {
				System.out.println(emp.cityStats());
			}
			System.out.println("===================================================");
			return;
		}
		
		Scanner cityscan = new Scanner(city);
		List<Emp> empList = EmpDAO.searchByCity(cityscan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. í•´ë‹¹ ë„ì‹œì—ì„œ ê·¼ë¬´í•˜ëŠ” ì§ì›ì„ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸ™ï¸ " + city + " ë‚´ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printStatsBySal(String ignored) {
		
		List<Emp> statsList = EmpDAO.getStatsBySal();
		if (statsList==null || statsList.isEmpty()) {
			System.out.println("ê¸‰ì—¬ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		System.out.println("ğŸ’° [ê¸‰ì—¬ í†µê³„]");
		System.out.println("===================================================");
		
		for (Emp emp : statsList) {
			System.out.println(emp.salStats());
		}
		System.out.println("===================================================");
		return;
	}
	
	public static void printAvgSalByDept(String ignored) {
		List<Emp> statsList = EmpDAO.getAvgSalByDept();
		if (statsList==null || statsList.isEmpty()) {
			System.out.println("ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		}
		System.out.println("ğŸ’¸ [ë¶€ì„œë³„ í‰ê·  ê¸‰ì—¬]");
		System.out.println("===================================================");
		
		for (Emp emp : statsList) {
			System.out.println(emp.avgSal());
		}
		System.out.println("===================================================");
		return;
	}
	
	public static void printMemByDeptMngr(String deptMngrFirstName) {
		if (deptMngrFirstName.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else if (deptMngrFirstName.equals("í†µê³„")) {
			List<Emp> statsList = EmpDAO.getMemStatsByDeptMngr();
			if (statsList==null || statsList.isEmpty()) {
				System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë¶€ì„œì› í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				return;
			}
			System.out.println("ğŸ‘¨â€ğŸ’¼ğŸ“Š [ë¶€ì„œì› í†µê³„]");
			System.out.println("===================================================");
			for (Emp emp : statsList) {
				System.out.println(emp.deptMemStats());
			}
			System.out.println("===================================================");
			return;
		}
		
		Scanner mngrscan = new Scanner(deptMngrFirstName);
		List<Emp> empList = EmpDAO.searchMemByDeptMngr(mngrscan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. í•´ë‹¹í•˜ëŠ” ë¶€ì„œì›ì„ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸ‘¨â€ğŸ’¼ " + deptMngrFirstName + " ë‚´ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
	public static void printEmpListByCountry(String countryName) {
		if (countryName.isEmpty()) {
			System.out.println("ì…ë ¥ê°’ì´ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else if (countryName.equals("í†µê³„")) {
			List<Emp> statsList = EmpDAO.getStatsByCountry();
			if (statsList==null || statsList.isEmpty()) {
				System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. ë‚˜ë¼ í†µê³„ë¥¼ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
				return;
			}
			System.out.println("ğŸŒğŸ“Š [ë‚˜ë¼ í†µê³„]");
			System.out.println("===================================================");
			for (Emp emp : statsList) {
				System.out.println(emp.countryStats());
			}
			System.out.println("===================================================");
			return;
		}
		
		Scanner countryscan = new Scanner(countryName);
		List<Emp> empList = EmpDAO.searchByCity(countryscan);
		if (empList==null || empList.isEmpty()) {
			System.out.println("ì˜ëª»ëœ ì…ë ¥ì…ë‹ˆë‹¤. í•´ë‹¹ ë‚˜ë¼ì—ì„œ ê·¼ë¬´í•˜ëŠ” ì§ì›ì„ ì¶œë ¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
			return;
		} else {
			System.out.println("ğŸŒ " + countryName + " ë‚´ ì§ì› ëª©ë¡");
			for (Emp emp : empList) {
				System.out.println(" - " + emp.firstName + " " + emp.lastName);
			}
		}
		return;
	}
	
}
